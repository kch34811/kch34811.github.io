<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>포도 주문 예약</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        .banner {
            background-color: #FF9800;
            color: white;
            padding: 15px 0;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            width: 100%;
            box-sizing: border-box;
            margin: 0;
        }
        .container {
            width: 90%;
            margin: 0 auto;
            padding-top: 20px;
        }
        .product-image {
            text-align: center;
            margin-top: 20px;
        }
        .product-image img {
            width: 100%;
            max-width: 600px;
            border-radius: 10px;
        }
        .product-description {
            margin-top: 20px;
            font-size: 16px;
            line-height: 1.6;
            text-align: center;
        }
        .buy-button {
            display: block;
            width: 200px;
            margin: 20px auto;
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            text-align: center;
            border-radius: 5px;
            text-decoration: none;
            font-size: 18px;
            cursor: pointer;
        }
        .buy-button:hover {
            background-color: #45a049;
        }
        #reservation-form {
            display: none;
            margin-top: 20px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background-color: #f9f9f9;
        }
        label {
            display: block;
            margin-top: 10px;
        }
        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        button[type="submit"] {
            background-color: #4CAF50;
            color: white;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
        }
        button[type="submit"]:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <div class="banner">
        가을이네 농장
    </div>

    <div class="container">
        <h1 style="text-align: center;">포도 주문 예약</h1>

        <div class="product-image">
            <!-- 같은 폴더 내의 이미지 파일 경로 -->
            <img src="grape.jpg" alt="포도">
        </div>

        <div class="product-description">
            <p>신선한 포도! 맛있고 당도가 높은 포도를 지금 예약하세요. 최상의 품질을 보장합니다.</p>
            <p>주문 수량에 따라 가격이 다르게 책정됩니다. 주문 후 빠르게 배송해 드립니다.</p>
        </div>

        <a class="buy-button" onclick="showForm()">구매하기</a>

        <form id="reservation-form">
            <label for="name">이름:</label>
            <input type="text" id="name" name="name" required>

            <label for="phone">전화번호:</label>
            <input type="text" id="phone" name="phone" required>

            <label for="sample6_postcode">우편번호:</label>
            <input type="text" id="sample6_postcode" placeholder="우편번호" required>
            <input type="button" onclick="sample6_execDaumPostcode()" value="우편번호 찾기"><br>

            <label for="sample6_address">주소:</label>
            <input type="text" id="sample6_address" placeholder="주소" required><br>

            <label for="sample6_detailAddress">상세주소:</label>
            <input type="text" id="sample6_detailAddress" placeholder="상세주소" required>
            
            <label for="sample6_extraAddress">참고항목:</label>
            <input type="text" id="sample6_extraAddress" placeholder="참고항목"><br>

            <label for="quantity">주문 수량:</label>
            <input type="number" id="quantity" name="quantity" required>

            <button type="submit">예약하기</button>
        </form>
    </div>

    <script>
        function sample6_execDaumPostcode() {
            new daum.Postcode({
                oncomplete: function(data) {
                    var addr = ''; // 주소 변수
                    var extraAddr = ''; // 참고항목 변수

                    if (data.userSelectedType === 'R') { 
                        addr = data.roadAddress;
                    } else { 
                        addr = data.jibunAddress;
                    }

                    if(data.userSelectedType === 'R'){
                        if(data.bname !== '' && /[동|로|가]$/g.test(data.bname)){
                            extraAddr += data.bname;
                        }
                        if(data.buildingName !== '' && data.apartment === 'Y'){
                            extraAddr += (extraAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                        }
                        if(extraAddr !== ''){
                            extraAddr = ' (' + extraAddr + ')';
                        }
                        document.getElementById("sample6_extraAddress").value = extraAddr;
                    
                    } else {
                        document.getElementById("sample6_extraAddress").value = '';
                    }

                    document.getElementById('sample6_postcode').value = data.zonecode;
                    document.getElementById("sample6_address").value = addr;
                    document.getElementById("sample6_detailAddress").focus();
                }
            }).open();
        }

        function showForm() {
            document.getElementById('reservation-form').style.display = 'block';
            setTimeout(function() {
                document.getElementById('reservation-form').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }

        document.getElementById('reservation-form').addEventListener('submit', function(event) {
            event.preventDefault();
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const postcode = document.getElementById('sample6_postcode').value;
            const address = document.getElementById('sample6_address').value;
            const detailAddress = document.getElementById('sample6_detailAddress').value;
            const extraAddress = document.getElementById('sample6_extraAddress').value;
            const quantity = document.getElementById('quantity').value;

            fetch('https://script.google.com/macros/s/AKfycbxF7LAt3jgpnjyL4lt79sbzPjO4ZbDvQiyo_hBzJFIdd7PXPWEeVXJujB5nLASfvxCg/exec', {
                method: 'POST',
                body: JSON.stringify({
                    name, 
                    phone, 
                    postcode, 
                    address, 
                    detailAddress, 
                    extraAddress, 
                    quantity
                }),
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('예약이 성공적으로 완료되었습니다.');
                } else {
                    alert('예약에 실패했습니다. 다시 시도해 주세요.');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('예약에 실패했습니다. 다시 시도해 주세요.');
            });
        });
    </script>
</body>
</html>
